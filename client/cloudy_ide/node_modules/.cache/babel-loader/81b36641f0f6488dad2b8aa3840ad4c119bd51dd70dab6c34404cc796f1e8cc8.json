{"ast":null,"code":"/**\n * Observable class prototype.\n *\n * @module observable\n */\n\nimport * as map from './map.js';\nimport * as set from './set.js';\nimport * as array from './array.js';\n\n/**\n * Handles named events.\n *\n * @template N\n */\nexport class Observable {\n  constructor() {\n    /**\n     * Some desc.\n     * @type {Map<N, any>}\n     */\n    this._observers = map.create();\n  }\n\n  /**\n   * @param {N} name\n   * @param {function} f\n   */\n  on(name, f) {\n    map.setIfUndefined(this._observers, name, set.create).add(f);\n  }\n\n  /**\n   * @param {N} name\n   * @param {function} f\n   */\n  once(name, f) {\n    var _this = this;\n    /**\n     * @param  {...any} args\n     */\n    const _f = function () {\n      _this.off(name, _f);\n      f(...arguments);\n    };\n    this.on(name, _f);\n  }\n\n  /**\n   * @param {N} name\n   * @param {function} f\n   */\n  off(name, f) {\n    const observers = this._observers.get(name);\n    if (observers !== undefined) {\n      observers.delete(f);\n      if (observers.size === 0) {\n        this._observers.delete(name);\n      }\n    }\n  }\n\n  /**\n   * Emit a named event. All registered event listeners that listen to the\n   * specified name will receive the event.\n   *\n   * @todo This should catch exceptions\n   *\n   * @param {N} name The event name.\n   * @param {Array<any>} args The arguments that are applied to the event listener.\n   */\n  emit(name, args) {\n    // copy all listeners to an array first to make sure that no event is emitted to listeners that are subscribed while the event handler is called.\n    return array.from((this._observers.get(name) || map.create()).values()).forEach(f => f(...args));\n  }\n  destroy() {\n    this._observers = map.create();\n  }\n}","map":{"version":3,"names":["map","set","array","Observable","constructor","_observers","create","on","name","f","setIfUndefined","add","once","_this","_f","off","arguments","observers","get","undefined","delete","size","emit","args","from","values","forEach","destroy"],"sources":["C:/Users/dzung/project/cloudy/client/cloudy_ide/node_modules/lib0/observable.js"],"sourcesContent":["/**\n * Observable class prototype.\n *\n * @module observable\n */\n\nimport * as map from './map.js'\nimport * as set from './set.js'\nimport * as array from './array.js'\n\n/**\n * Handles named events.\n *\n * @template N\n */\nexport class Observable {\n  constructor () {\n    /**\n     * Some desc.\n     * @type {Map<N, any>}\n     */\n    this._observers = map.create()\n  }\n\n  /**\n   * @param {N} name\n   * @param {function} f\n   */\n  on (name, f) {\n    map.setIfUndefined(this._observers, name, set.create).add(f)\n  }\n\n  /**\n   * @param {N} name\n   * @param {function} f\n   */\n  once (name, f) {\n    /**\n     * @param  {...any} args\n     */\n    const _f = (...args) => {\n      this.off(name, _f)\n      f(...args)\n    }\n    this.on(name, _f)\n  }\n\n  /**\n   * @param {N} name\n   * @param {function} f\n   */\n  off (name, f) {\n    const observers = this._observers.get(name)\n    if (observers !== undefined) {\n      observers.delete(f)\n      if (observers.size === 0) {\n        this._observers.delete(name)\n      }\n    }\n  }\n\n  /**\n   * Emit a named event. All registered event listeners that listen to the\n   * specified name will receive the event.\n   *\n   * @todo This should catch exceptions\n   *\n   * @param {N} name The event name.\n   * @param {Array<any>} args The arguments that are applied to the event listener.\n   */\n  emit (name, args) {\n    // copy all listeners to an array first to make sure that no event is emitted to listeners that are subscribed while the event handler is called.\n    return array.from((this._observers.get(name) || map.create()).values()).forEach(f => f(...args))\n  }\n\n  destroy () {\n    this._observers = map.create()\n  }\n}\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;;AAEA,OAAO,KAAKA,GAAG,MAAM,UAAU;AAC/B,OAAO,KAAKC,GAAG,MAAM,UAAU;AAC/B,OAAO,KAAKC,KAAK,MAAM,YAAY;;AAEnC;AACA;AACA;AACA;AACA;AACA,OAAO,MAAMC,UAAU,CAAC;EACtBC,WAAWA,CAAA,EAAI;IACb;AACJ;AACA;AACA;IACI,IAAI,CAACC,UAAU,GAAGL,GAAG,CAACM,MAAM,EAAE;EAChC;;EAEA;AACF;AACA;AACA;EACEC,EAAEA,CAAEC,IAAI,EAAEC,CAAC,EAAE;IACXT,GAAG,CAACU,cAAc,CAAC,IAAI,CAACL,UAAU,EAAEG,IAAI,EAAEP,GAAG,CAACK,MAAM,CAAC,CAACK,GAAG,CAACF,CAAC,CAAC;EAC9D;;EAEA;AACF;AACA;AACA;EACEG,IAAIA,CAAEJ,IAAI,EAAEC,CAAC,EAAE;IAAA,IAAAI,KAAA;IACb;AACJ;AACA;IACI,MAAMC,EAAE,GAAG,SAAAA,CAAA,EAAa;MACtBD,KAAI,CAACE,GAAG,CAACP,IAAI,EAAEM,EAAE,CAAC;MAClBL,CAAC,CAAC,GAAAO,SAAO,CAAC;IACZ,CAAC;IACD,IAAI,CAACT,EAAE,CAACC,IAAI,EAAEM,EAAE,CAAC;EACnB;;EAEA;AACF;AACA;AACA;EACEC,GAAGA,CAAEP,IAAI,EAAEC,CAAC,EAAE;IACZ,MAAMQ,SAAS,GAAG,IAAI,CAACZ,UAAU,CAACa,GAAG,CAACV,IAAI,CAAC;IAC3C,IAAIS,SAAS,KAAKE,SAAS,EAAE;MAC3BF,SAAS,CAACG,MAAM,CAACX,CAAC,CAAC;MACnB,IAAIQ,SAAS,CAACI,IAAI,KAAK,CAAC,EAAE;QACxB,IAAI,CAAChB,UAAU,CAACe,MAAM,CAACZ,IAAI,CAAC;MAC9B;IACF;EACF;;EAEA;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACEc,IAAIA,CAAEd,IAAI,EAAEe,IAAI,EAAE;IAChB;IACA,OAAOrB,KAAK,CAACsB,IAAI,CAAC,CAAC,IAAI,CAACnB,UAAU,CAACa,GAAG,CAACV,IAAI,CAAC,IAAIR,GAAG,CAACM,MAAM,EAAE,EAAEmB,MAAM,EAAE,CAAC,CAACC,OAAO,CAACjB,CAAC,IAAIA,CAAC,CAAC,GAAGc,IAAI,CAAC,CAAC;EAClG;EAEAI,OAAOA,CAAA,EAAI;IACT,IAAI,CAACtB,UAAU,GAAGL,GAAG,CAACM,MAAM,EAAE;EAChC;AACF"},"metadata":{},"sourceType":"module","externalDependencies":[]}